// Attempt 1
import serial
import time
from ctypes import cast, POINTER
from comtypes import CLSCTX_ALL
from pycaw.pycaw import AudioUtilities, IAudioEndpointVolume

# === Serial Setup ===
ser = serial.Serial('COM3', 9600, timeout=1)  # replace COM5 with your port
time.sleep(2)  # wait for Arduino to reset

# === Audio Setup ===
# Get default audio device
devices = AudioUtilities.GetSpeakers()
interface = devices._ctl.QueryInterface(IAudioEndpointVolume)
volume = cast(interface, POINTER(IAudioEndpointVolume))

last_vol = -1

# === Main Loop ===
while True:
    try:
        line = ser.readline().decode().strip()
        if not line:
            continue
        val = int(line)
        vol = max(0.0, min(1.0, val / 1023.0))  # clamp 0-1
        if abs(vol - last_vol) > 0.01:
            volume.SetMasterVolumeLevelScalar(vol, None)
            last_vol = vol
    except Exception as e:
        print("Error:", e)

// Attempt 2
import serial
from ctypes import cast, POINTER
from comtypes import CLSCTX_ALL
from pycaw.pycaw import AudioUtilities, IAudioEndpointVolume

# === Serial Setup ===
# Replace 'COM3' with your Arduino's port
ser = serial.Serial('COM3', 9600, timeout=1)

# === Audio Setup ===
devices = AudioUtilities.GetSpeakers()
interface = devices.Activate(IAudioEndpointVolume._iid_, CLSCTX_ALL, None)
volume = cast(interface, POINTER(IAudioEndpointVolume))

# === Variables for smoothing ===
last_vol = -1

while True:
    try:
        # Read potentiometer value from Arduino
        line = ser.readline().decode().strip()
        if line == "":
            continue
        val = int(line)
        
        # Map 0-1023 to 0.0-1.0
        vol = val / 1023.0
        vol = max(0.0, min(1.0, vol))  # clamp
        
        # Only update if change is noticeable
        if abs(vol - last_vol) > 0.01:
            volume.SetMasterVolumeLevelScalar(vol, None)
            last_vol = vol
            
    except Exception as e:
        # Ignore decoding errors
        pass

// Attempt 3
import serial
from ctypes import cast, POINTER
from comtypes import CLSCTX_ALL
from pycaw.pycaw import AudioUtilities, IAudioEndpointVolume

ser = serial.Serial('COM3', 9600)  # Replace COM3 with your port

devices = AudioUtilities.GetSpeakers()
interface = devices.Activate(IAudioEndpointVolume._iid_, CLSCTX_ALL, None)
volume = cast(interface, POINTER(IAudioEndpointVolume))

while True:
    try:
        val = int(ser.readline().decode().strip())
        vol = val / 1023  # scale 0-1
        volume.SetMasterVolumeLevelScalar(vol, None)
    except:
        pass
